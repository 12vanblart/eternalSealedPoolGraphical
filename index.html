<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Clicker Test</title>
    <!-- D3 CDN -->
    <script src="https://d3js.org/d3.v5.js"></script>
    <!-- Chart.js CDN-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.js"></script>
    <link rel="stylesheet" href="./index.css">
</head>

<body>
    <div id="container">
        <!-- Testing Chart.js -->
        <canvas id="myChart" width="400" height="400"></canvas>
        <!-- Mono Color Playable -->
        <table>
            <tr>
                <td colspan="2">
                    <h1>Playables</h1>
                </td>
            </tr>
            <tr>
                <td>
                    Primal:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`P`)">
                            -
                        </button>
                        <input id="P" type="number" value="40" min="0" onchange="monoPlayables()">
                        <button onclick="increment(`P`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Justice:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`J`)">
                            -
                        </button>
                        <input id="J" type="number" value="3" min="0" onchange="monoPlayables()">
                        <button onclick="increment(`J`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Shadow:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`S`)">
                            -
                        </button>
                        <input id="S" type="number" value="3" min="0" onchange="monoPlayables()">
                        <button onclick="increment(`S`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Fire:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`F`)">
                            -
                        </button>
                        <input id="F" type="number" value="3" min="0" onchange="monoPlayables()">
                        <button onclick="increment(`F`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Time:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`T`)">
                            -
                        </button>
                        <input id="T" type="number" value="3" min="0" onchange="monoPlayables()">
                        <button onclick="increment(`T`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <div id="bestMono"></div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <div id="monoplayablegraph"></div>
                </td>
            </tr>
        </table>
        <!-- Dual Color Playable -->
        <table>
            <tr>
                <td colspan="2">
                    <h1>Duals</h1>
                </td>
            </tr>
            <tr>
                <td>
                    Hooru:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`JP`)">
                            -
                        </button>
                        <input id="JP" type="number" value="40" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`JP`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Argenport:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`JS`)">
                            -
                        </button>
                        <input id="JS" type="number" value="3" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`JS`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Combrei:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`JT`)">
                            -
                        </button>
                        <input id="JT" type="number" value="3" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`JT`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Rakano:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`JF`)">
                            -
                        </button>
                        <input id="JF" type="number" value="3" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`JF`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Praxis:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`FT`)">
                            -
                        </button>
                        <input id="FT" type="number" value="3" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`FT`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Skycrag:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`FP`)">
                            -
                        </button>
                        <input id="FP" type="number" value="40" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`FP`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Stonescar:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`FS`)">
                            -
                        </button>
                        <input id="FS" type="number" value="3" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`FS`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Xenan:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`ST`)">
                            -
                        </button>
                        <input id="ST" type="number" value="3" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`ST`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Feln:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`PS`)">
                            -
                        </button>
                        <input id="PS" type="number" value="3" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`PS`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Elysian:
                </td>
                <td>
                    <div>
                        <button onclick="decrement(`PT`)">
                            -
                        </button>
                        <input id="PT" type="number" value="3" min="0" onchange="dualPlayables()">
                        <button onclick="increment(`PT`)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <div id="bestDual"></div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <div id="dualplayablegraph"></div>
                </td>
            </tr>
        </table>


    </div>


</body>

<script>



    // Init charts
    monoPlayables()
    dualPlayables()


    function increment(selector) {
        var inputField = document.getElementById(selector);
        inputField.stepUp();
        monoPlayables();
        dualPlayables();
    }

    function decrement(selector) {
        var inputField = document.getElementById(selector);
        inputField.stepDown();
        monoPlayables();
        dualPlayables();
    }

    function monoPlayables() {
        // Data
        var primal = {
            color: "navy",
            count: document.getElementById('P').value,
            name: "Primal"
        },
            justice = {
                color: "green",
                count: document.getElementById('J').value,
                name: "Justice"
            },
            time = {
                color: "gold",
                count: document.getElementById('T').value,
                name: "Time"
            },
            shadow = {
                color: "rebeccapurple",
                count: document.getElementById('S').value,
                name: "Shadow"
            },
            fire = {
                color: "firebrick",
                count: document.getElementById('F').value,
                name: "Fire"
            }
        //  the data that powers the chart (legacy for D3; May not need? )
        var chartdata = [primal, justice, time, shadow, fire];

        // Set recommended 
        var bestCount = chartdata.reduce((max, objectIn) => Math.max(objectIn.count, max), 0) / 2
        var bestMono = ""
        for (var i = 0; i < chartdata.length; i++) {
            if (chartdata[i].count == bestCount * 2) {
                bestMono = chartdata[i].name
            }
        }
        document.getElementById("bestMono").innerHTML = "<b>Best: </b>" + bestMono

        // Chart.js Test 
        var ctx = document.getElementById("myChart");
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ["Fire", "Primal", "Time", "Justice", "Shadow"],
                datasets: [{
                    label: '# of Votes',
                    data: [fire.count, primal.count, time.count, justice.count, shadow.count],
                    backgroundColor: [
                        fire.color,
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    }

    function dualPlayables() {
        /*Remove old svg's*/
        d3.select("#dualplayablegraph svg").remove();

        /*Data Set*/
        var hooru = {
            color: "teal",
            count: eval(document.getElementById('JP').value) + eval(document.getElementById('J').value) + eval(document.getElementById('P').value),
            name: "Hooru"
        },
            argenport = {
                color: "olive",
                count: eval(document.getElementById('JS').value) + eval(document.getElementById('J').value) + eval(document.getElementById('S').value),
                name: "Argenport"
            },
            combrei = {
                color: "yellowgreen",
                count: eval(document.getElementById('JT').value) + eval(document.getElementById('J').value) + eval(document.getElementById('T').value),
                name: "Combrei"
            },
            rakano = {
                color: "maroon",
                count: eval(document.getElementById('JF').value) + eval(document.getElementById('J').value) + eval(document.getElementById('F').value),
                name: "Rakano"
            },
            praxis = {
                color: "goldenrod",
                count: eval(document.getElementById('FT').value) + eval(document.getElementById('F').value) + eval(document.getElementById('T').value),
                name: "Praxis"
            },
            skycrag = {
                color: "crimson",
                count: eval(document.getElementById('FP').value) + eval(document.getElementById('F').value) + eval(document.getElementById('P').value),
                name: "Skycrag"
            },
            stonescar = {
                color: "mediumvioletred",
                count: eval(document.getElementById('FS').value) + eval(document.getElementById('F').value) + eval(document.getElementById('S').value),
                name: "Stonescar"
            },
            xenan = {
                color: "peachpuff",
                count: eval(document.getElementById('ST').value) + eval(document.getElementById('S').value) + eval(document.getElementById('T').value),
                name: "Xenan"
            },
            feln = {
                color: "indigo",
                count: eval(document.getElementById('PS').value) + eval(document.getElementById('P').value) + eval(document.getElementById('S').value),
                name: "Feln"
            },
            elysian = {
                color: "powderblue",
                count: eval(document.getElementById('PT').value) + eval(document.getElementById('P').value) + eval(document.getElementById('T').value),
                name: "Elysian"
            }
        /*Chart Settings*/
        //  the size of the overall svg element
        var height = 100
        var width = 160

        //  the width of each bar and the offset between each bar
        var barWidth = 10
        var barOffset = 5


        //  the data that powers the bar chart, a simple array of numeric values
        var chartdata = [hooru, argenport, combrei, rakano, praxis, skycrag, stonescar, xenan, feln, elysian];


        /*Insert Data => Graph*/
        d3.select('#dualplayablegraph').append('svg')
            .attr('width', width)
            .attr('height', height)
            .style('background', 'snow')
            .selectAll('rect').data(chartdata)
            .enter().append('rect')
            .attr('width', barWidth)
            .attr('height', function (data) {
                return data.count;
            })
            .attr('x', function (data, i) {
                return i * (barWidth + barOffset);
            })
            .attr('y', function (data) {
                return height - data.count;
            })
            .style('fill', function (data) {
                return data.color
            });

        //Set recommended 
        var bestCount = chartdata.reduce((max, objectIn) => Math.max(objectIn.count, max), 0) / 2
        var bestDual = ""
        for (var i = 0; i < chartdata.length; i++) {
            if (chartdata[i].count == bestCount * 2) {
                bestDual = chartdata[i].name
            }
        }
        document.getElementById("bestDual").innerHTML = "<b>Best: </b>" + bestDual
    }

</script>

</html>