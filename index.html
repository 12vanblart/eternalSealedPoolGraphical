<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sealed Analysis</title>
    <!-- Chart.js CDN-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.js"></script>
    <link rel="stylesheet" href="./index.css">
</head>

<body>
    <div id="container">
        <!-- Testing Chart.js -->
        <div class="chart-size-m">
            <canvas id="myChart"></canvas>
        </div>
        <!-- Mono Color Playable -->
        <table>
            <tr>
                <td colspan="2">
                    <h1>Playables</h1>
                </td>
            </tr>
            <tr>
                <td>
                    Primal:
                </td>
                <td>
                    <div>
                        <button onclick="monoDecrement(`P`, 1)">
                            -
                        </button>
                        <input id="P" type="number" value="10" min="0" onchange="monoPlayables(`P`, 1)">
                        <button onclick="monoIncrement(`P`, 1)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Justice:
                </td>
                <td>
                    <div>
                        <button onclick="monoDecrement(`J`, 3)">
                            -
                        </button>
                        <input id="J" type="number" value="3" min="0" onchange="monoPlayables(`J`, 3)">
                        <button onclick="monoIncrement(`J`, 3)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Shadow:
                </td>
                <td>
                    <div>
                        <button onclick="monoDecrement(`S`, 4)">
                            -
                        </button>
                        <input id="S" type="number" value="3" min="0" onchange="monoPlayables(`S`, 4)">
                        <button onclick="monoIncrement(`S`, 4)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Fire:
                </td>
                <td>
                    <div>
                        <button onclick="monoDecrement(`F`, 0)">
                            -
                        </button>
                        <input id="F" type="number" value="3" min="0" onchange="monoPlayables(`F`, 0)">
                        <button onclick="monoIncrement(`F`, 0)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Time:
                </td>
                <td>
                    <div>
                        <button onclick="monoDecrement(`T`, 2)">
                            -
                        </button>
                        <input id="T" type="number" value="3" min="0" onchange="monoPlayables(`T`, 2)">
                        <button onclick="monoIncrement(`T`, 2)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <div id="bestMono"></div>
                </td>
            </tr>
        </table>

        <!-- Mono Color Removal -->
        <table>
            <tr>
                <td colspan="2">
                    <h1>Removal</h1>
                </td>
            </tr>
            <tr>
                <td>
                    Primal:
                </td>
                <td>
                    <div>
                        <button onclick="removalDecrement(`Pr`, 1)">
                            -
                        </button>
                        <input id="Pr" type="number" value="10" min="0" onchange="removalPlayables()">
                        <button onclick="removalIncrement(`Pr`, 1)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Justice:
                </td>
                <td>
                    <div>
                        <button onclick="removalDecrement(`Jr`, 3)">
                            -
                        </button>
                        <input id="Jr" type="number" value="3" min="0" onchange="removalPlayables()">
                        <button onclick="removalIncrement(`Jr`, 3)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Shadow:
                </td>
                <td>
                    <div>
                        <button onclick="removalDecrement(`Sr`, 4)">
                            -
                        </button>
                        <input id="Sr" type="number" value="3" min="0" onchange="removalPlayables()">
                        <button onclick="removalIncrement(`Sr`, 4)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Fire:
                </td>
                <td>
                    <div>
                        <button onclick="removalDecrement(`Fr`, 0)">
                            -
                        </button>
                        <input id="Fr" type="number" value="3" min="0" onchange="removalPlayables()">
                        <button onclick="removalIncrement(`Fr`, 0)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Time:
                </td>
                <td>
                    <div>
                        <button onclick="removalDecrement(`Tr`, 2)">
                            -
                        </button>
                        <input id="Tr" type="number" value="3" min="0" onchange="removalPlayables()">
                        <button onclick="removalIncrement(`Tr`, 2)">
                            +
                        </button>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <div id="bestRemoval"></div>
                </td>
            </tr>
        </table>

    </div>


</body>

<script>
    // Variables
    var primal = {
        count: document.getElementById('P').value,
        removal: document.getElementById('Pr').value,
        name: "Primal"
    },
        justice = {
            count: document.getElementById('J').value,
            removal: document.getElementById('Jr').value,
            name: "Justice"
        },
        time = {
            count: document.getElementById('T').value,
            removal: document.getElementById('Tr').value,
            name: "Time"
        },
        shadow = {
            count: document.getElementById('S').value,
            removal: document.getElementById('Sr').value,
            name: "Shadow"
        },
        fire = {
            count: document.getElementById('F').value,
            removal: document.getElementById('Fr').value,
            name: "Fire"
        }
    var ctx = document.getElementById("myChart");
    var myChart

    // Init
    monoRec()
    initialize()

    // Chart.js Test 
    function initialize() {

        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ["F", "P", "T", "J", "S"],
                datasets: [{
                    label: 'Count',
                    data: [fire.count, primal.count, time.count, justice.count, shadow.count],
                    backgroundColor: [
                        'rgba(255,99,132,0.4)',
                        'rgba(54, 162, 235, 0.4)',
                        'rgba(255, 206, 86, 0.4)',
                        'rgba(75, 192, 192, 0.4)',
                        'rgba(153, 102, 255, 0.4)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)'
                    ],
                    borderWidth: 1
                },
                {
                    label: 'Removal',
                    data: [fire.removal, primal.removal, time.removal, justice.removal, shadow.removal],
                    backgroundColor: [
                        'rgba(255,99,132,0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                legend: {
                    display: false
                },
                scales: {
                    xAxes: [{
                        stacked: true,
                    }],
                    yAxes: [{
                        stacked: true,
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    }

    // Mono Playable Functions
    function monoIncrement(selector, indicator) {
        var inputField = document.getElementById(selector);
        inputField.stepUp();
        myChart.data.datasets[0].data[indicator] = inputField.value
        myChart.update()
        monoRec()
    }

    function monoDecrement(selector, indicator) {
        var inputField = document.getElementById(selector);
        inputField.stepDown();
        myChart.data.datasets[0].data[indicator] = inputField.value
        myChart.update()
        monoRec()
    }

    function monoPlayables(selector, indicator) {
        var inputField = document.getElementById(selector);
        myChart.data.datasets[0].data[indicator] = inputField.value
        myChart.update()
        monoRec()
    }

    // Mono Removal Functions
    function removalIncrement(selector, indicator) {
        var inputField = document.getElementById(selector);
        inputField.stepUp();
        myChart.data.datasets[1].data[indicator] = inputField.value
        myChart.update()
        monoRec()
    }

    function removalDecrement(selector, indicator) {
        var inputField = document.getElementById(selector);
        inputField.stepDown();
        myChart.data.datasets[1].data[indicator] = inputField.value
        myChart.update()
        monoRec()
    }

    function removalPlayables(selector, indicator) {
        var inputField = document.getElementById(selector);
        myChart.data.datasets[0].data[indicator] = inputField.value
        myChart.update()
        monoRec()
    }

    // Recommended Functions
    function monoRec() {
        // Playables
        primal.count = document.getElementById('P').value
        justice.count = document.getElementById('J').value
        time.count = document.getElementById('T').value
        shadow.count = document.getElementById('S').value
        fire.count = document.getElementById('F').value

        // Removal
        primal.removal = document.getElementById('Pr').value
        justice.removal = document.getElementById('Jr').value
        time.removal = document.getElementById('Tr').value
        shadow.removal = document.getElementById('Sr').value
        fire.removal = document.getElementById('Fr').value

        //  the data that powers the chart (legacy for D3; May not need? )
        var chartdata = [primal, justice, time, shadow, fire];
        var bestCount = chartdata.reduce((max, objectIn) => Math.max(objectIn.count + objectIn.removal, max), 0)
        var bestMono = ""
        for (var i = 0; i < chartdata.length; i++) {
            if (chartdata[i].count == bestCount) {
                bestMono = chartdata[i].name
            }
        }
        document.getElementById("bestMono").innerHTML = "<b>Best: </b>" + bestMono
    }
</script>

</html>